# Rules & Settings Reference (repo-grounded)

| Setting name / key | Allowed values | Default behavior | UI location (route/component) | DB location | Quick find (search terms / files) |
| --- | --- | --- | --- | --- | --- |
| `rule_config.strict_age` | `true/false` | Defaults to `true` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.strict_age`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `strict_age` in `src/pages/Settings.tsx` and `supabase/functions/allocatePrizes/index.ts`. |
| `rule_config.allow_missing_dob_for_age` | `true/false` | Defaults to `false` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.allow_missing_dob_for_age`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `allow_missing_dob_for_age` in Settings + `allocatePrizes`. |
| `rule_config.max_age_inclusive` | `true/false` | Defaults to `true` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.max_age_inclusive`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `max_age_inclusive` in Settings + `allocatePrizes`. |
| `rule_config.allow_unrated_in_rating` | `true/false` | Defaults to `false` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.allow_unrated_in_rating`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `allow_unrated_in_rating` in Settings + `allocatePrizes`. |
| `rule_config.main_vs_side_priority_mode` | `main_first` or `place_first` | Defaults to `place_first` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.main_vs_side_priority_mode`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `main_vs_side_priority_mode` in Settings + `allocatePrizes`. |
| `rule_config.age_band_policy` | `non_overlapping` or `overlapping` | Defaults to `non_overlapping` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.age_band_policy`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `age_band_policy` in Settings + `allocatePrizes`. |
| `rule_config.multi_prize_policy` | `single`, `main_plus_one_side`, `unlimited` | Defaults to `single` in settings form. (src/pages/Settings.tsx → Settings) | `/t/:id/settings` → Settings form. (src/App.tsx → App; src/pages/Settings.tsx → Settings) | `rule_config.multi_prize_policy`. (src/integrations/supabase/types.ts → Database.public.Tables.rule_config.Row) | Search `multi_prize_policy` in Settings + `allocatePrizes`. |
| `categories.criteria_json.min_age` / `max_age` | Numeric ages | No explicit defaults; enforced only if provided and strict age is enabled. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-max-age` / `criteria-min-age` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.gender` | `F`, `M`, `M_OR_UNKNOWN`, or empty (open) | Open gender when empty; youngest categories force gender by `category_type`. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility, isYoungestCategory) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-gender` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.min_rating` / `max_rating` | Numeric ratings | No defaults; enforced only when set. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-min-rating` / `criteria-max-rating` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.include_unrated` | `true/false` | Falls back to legacy `allow_unrated_in_rating` or max-only rules when unset. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-include-unrated` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.unrated_only` | `true/false` | When true, rated players are excluded from the category. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-unrated-only` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.allowed_states` / `allowed_cities` / `allowed_clubs` | Array of strings | Only enforced when list is non-empty. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-states`, `criteria-cities`, `criteria-clubs` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.allowed_groups` / `allowed_types` | Array of strings | Only enforced when list is non-empty. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-groups` / `criteria-types` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.allowed_disabilities` | Array of strings | Only enforced when list is non-empty. (supabase/functions/allocatePrizes/index.ts → evaluateEligibility) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | `categories.criteria_json`. (src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `criteria-disability` in `src/pages/TournamentSetup.tsx`. |
| `categories.criteria_json.category_type` | `standard`, `youngest_female`, `youngest_male` (and any other stored types) | Defaults to `standard` in setup when none is selected. (src/pages/TournamentSetup.tsx → TournamentSetup) | Category criteria sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup) | Stored in `categories.criteria_json` (category_type). (src/pages/TournamentSetup.tsx → TournamentSetup; src/integrations/supabase/types.ts → Database.public.Tables.categories.Row) | Search `category_type` in `src/pages/TournamentSetup.tsx` and `allocatePrizes`. |
| `institution_prize_groups.group_by` | `club`, `city`, `state`, `group_label`, `type_label` | Defaults to `club` in team prize rules. (src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet; src/components/team-prizes/types.ts → GROUP_BY_OPTIONS) | Team prizes editor sheet in Tournament Setup. (src/pages/TournamentSetup.tsx → TournamentSetup; src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet) | `institution_prize_groups.group_by`. (src/integrations/supabase/types.ts → Database.public.Tables.institution_prize_groups.Row) | Search `group_by` in `TeamPrizeRulesSheet` and `allocateInstitutionPrizes`. |
| `institution_prize_groups.team_size` / `female_slots` / `male_slots` | Integers (`team_size >= 1`, slots ≥ 0) | Defaults: team_size=4, female_slots=0, male_slots=0. (src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet) | Team prize rules sheet. (src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet) | `institution_prize_groups.team_size`, `female_slots`, `male_slots`. (src/integrations/supabase/types.ts → Database.public.Tables.institution_prize_groups.Row) | Search `team-size`, `female-slots`, `male-slots` in TeamPrizeRulesSheet. |
| `institution_prize_groups.scoring_mode` | `by_top_k_score` (only option today) | Defaults to `by_top_k_score`. (src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet; src/components/team-prizes/types.ts → SCORING_MODE_OPTIONS) | Team prize rules sheet. (src/components/team-prizes/TeamPrizeRulesSheet.tsx → TeamPrizeRulesSheet) | `institution_prize_groups.scoring_mode`. (src/integrations/supabase/types.ts → Database.public.Tables.institution_prize_groups.Row) | Search `scoring_mode` in TeamPrizeRulesSheet. |
