# Operations, Release & Testing (repo-grounded)

## Release gate checklist (from CI + scripts)
- **Build:** `npm run build` runs Vite build. (package.json → scripts.build; .github/workflows/ci.yml → Build)
- **Lint:** `npm run lint` runs ESLint. (package.json → scripts.lint; .github/workflows/ci.yml → Lint)
- **Unit tests:** `npm run test:unit` runs Vitest. (package.json → scripts.test:unit; .github/workflows/ci.yml → Unit tests)
- **E2E (Playwright subsets):** CI runs `npm run test:smoke`, `npm run test:swiss`, `npm run test:alloc`, `npm run test:ux`. (.github/workflows/ci.yml → Test - Smoke/Swiss/Allocator/UX)
- **CSV Guard:** CI runs `npm run assert:no-csv`. (.github/workflows/ci.yml → CSV Guard)

## How to run locally (repo scripts)
- `npm run build` (package.json → scripts.build)
- `npm run lint` (package.json → scripts.lint)
- `npm run test:unit` (package.json → scripts.test:unit)
- `npm run test:e2e` (package.json → scripts.test:e2e)
- `npm run test:smoke` (package.json → scripts.test:smoke)
- `npm run test:swiss` (package.json → scripts.test:swiss)
- `npm run test:alloc` (package.json → scripts.test:alloc)
- `npm run test:ux` (package.json → scripts.test:ux)
- `npm run qa` (build + select Playwright suites). (package.json → scripts.qa)

## What E2E covers (Playwright specs)
- `e2e/allocate-flow.spec.ts`: Allocation review flow. (e2e/allocate-flow.spec.ts → test.describe)
- `e2e/allocator-null-safety.spec.ts`: Allocator null-safety scenarios. (e2e/allocator-null-safety.spec.ts → test.describe)
- `e2e/allocator-tie-break.spec.ts`: Deterministic tie-breaking in allocator. (e2e/allocator-tie-break.spec.ts → test.describe)
- `e2e/auth-regression.spec.ts`: Auth + authorization regression coverage. (e2e/auth-regression.spec.ts → test.describe.serial)
- `e2e/category-rules.spec.ts`: Category rules round-trip. (e2e/category-rules.spec.ts → test.describe)
- `e2e/export-print.spec.ts`: Print export flow. (e2e/export-print.spec.ts → test.describe)
- `e2e/import-conflicts.spec.ts`: Player import conflict review. (e2e/import-conflicts.spec.ts → test.describe)
- `e2e/import-dedup.spec.ts`: Import deduplication heuristics. (e2e/import-dedup.spec.ts → test.describe)
- `e2e/import-error-xlsx.spec.ts`: Import error XLSX export workflow. (e2e/import-error-xlsx.spec.ts → test.describe)
- `e2e/import-logs.spec.ts`: Import logs staging smoke. (e2e/import-logs.spec.ts → test.describe)
- `e2e/import-server-fallback.spec.ts`: Server import fallback. (e2e/import-server-fallback.spec.ts → test.describe)
- `e2e/import-swiss-manager.spec.ts`: Swiss-Manager staging suite. (e2e/import-swiss-manager.spec.ts → test.describe)
- `e2e/main-prizes.spec.ts`: Main prizes hydration. (e2e/main-prizes.spec.ts → test.describe)
- `e2e/public-smoke.spec.ts`: Public navigation smoke tests. (e2e/public-smoke.spec.ts → test.describe)
- `e2e/ux-improvements.spec.ts`: UX improvements suite. (e2e/ux-improvements.spec.ts → test.describe)

## Common failure modes + fixes (only grounded items)
- **Playwright browsers not installed:** pretest scripts install Chromium unless `PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1` is set, in which case installs are skipped. (scripts/ensure-playwright-browsers.mjs → skipDownload logic)
- **CI-only guard mismatch:** CI runs `npm run assert:no-csv`, which is not listed in `package.json` scripts. (.github/workflows/ci.yml → CSV Guard; package.json → scripts)
